<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Muro - Calculadora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css">
<style>
.header {background:#1f2937;color:white;padding:1rem;text-align:center;position:sticky;top:0;z-index:1000}
.nav-menu{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center;margin-top:.5rem}
.nav-link{background:#f0f0f0;color:#1f2937;padding:.5rem 1rem;border-radius:10px;text-decoration:none;font-weight:500}
.container{max-width:900px;margin:2rem auto;padding:0 1rem}
.card{background:#fff;padding:1rem;margin-bottom:1rem;border-radius:14px;box-shadow:0 4px 8px rgba(0,0,0,.05)}
.card label{font-weight:500;display:block;margin-top:.5rem}
.card input,.card select{width:100%;padding:.5rem;margin-top:.2rem;border-radius:8px;border:1px solid #ccc}
.btn-primary{display:block;margin:1rem auto;padding:.7rem 2rem;background:#1f2937;color:white;border:none;border-radius:10px}
.result{background:#f9f9f9;padding:1rem;border-radius:12px;margin-top:1rem}
footer{text-align:center;padding:1rem;margin-top:2rem;color:#6b7280;font-size:.9rem}
h4{margin-top:1rem}
</style>
</head>

<body>

<header class="header">
<h1>Calculadora de Muro</h1>
<nav class="nav-menu">
<a href="index.html" class="nav-link">Inicio</a>
<a href="piso.html" class="nav-link">Piso</a>
<a href="cubierta.html" class="nav-link">Cubierta</a>
<a href="cimentacion.html" class="nav-link">Cimentación</a>
<a href="estructura.html" class="nav-link">Estructura</a>
<a href="falso-techo.html" class="nav-link">Falso Techo</a>
<a href="pintura.html" class="nav-link">Pintura</a>
<a href="precios.html" class="nav-link">Precios</a>
</nav>
</header>

<main class="container">

<div class="card">
<label>Tipo de muro</label>
<select id="tipoMuro">
<option value="">-- Selecciona --</option>
<option value="bloque">Bloque</option>
<option value="ladrillo">Ladrillo</option>
<option value="hormigon">Hormigón armado</option>
</select>
</div>

<div class="card" id="materialCard" style="display:none;">
<label>Material específico</label>
<select id="materialMuro"></select>
</div>

<div class="card">
<label>Largo (m)</label>
<input type="number" id="largo">
<label>Ancho (m)</label>
<input type="number" id="ancho">
<label id="labelAlto" style="display:none;">Alto (m)</label>
<input type="number" id="alto" style="display:none;">
<label>Área / Volumen</label>
<input type="number" id="area" readonly>
</div>

<button class="btn-primary" onclick="calcularMuro()">Calcular</button>
<button class="btn-primary" style="background:#ef4444" onclick="borrarMuro()">Borrar</button>

<div id="resultado" class="result" style="display:none"></div>

</main>

<footer>Arq. Emanuel Silva Riambaut</footer>

<script>
let precios = JSON.parse(localStorage.getItem('precios')) || {};
let bloquesPrecio = JSON.parse(localStorage.getItem('preciosBloques')) || [];

document.getElementById('tipoMuro').addEventListener('change',function(){
const tipo=this.value;
const sel=document.getElementById('materialMuro');
sel.innerHTML='';
document.getElementById('materialCard').style.display='block';

alto.style.display = tipo==='hormigon'?'block':'none';
labelAlto.style.display = tipo==='hormigon'?'block':'none';

if(tipo==='bloque'){
bloquesPrecio.forEach(b=>{
let o=document.createElement('option');
o.value=b.nombre;
o.textContent=b.nombre;
sel.appendChild(o);
});
}
if(tipo==='ladrillo'){
['Ladrillo común','Ladrillo hueco'].forEach(l=>{
let o=document.createElement('option');
o.value=l; o.textContent=l;
sel.appendChild(o);
});
}
if(tipo==='hormigon'){
let o=document.createElement('option');
o.value='Hormigón armado';
o.textContent='Hormigón armado';
sel.appendChild(o);
}
});

['largo','ancho','alto'].forEach(id=>{
document.getElementById(id).addEventListener('input',()=>{
let l=+largo.value||0,a=+ancho.value||0,h=+alto.value||0;
area.value=(tipoMuro.value==='hormigon'?l*a*h:l*a).toFixed(2);
});
});

function calcularMuro(){
const tipo=tipoMuro.value;
const l=+largo.value||0,a=+ancho.value||0,h=+alto.value||0;
const medida=+area.value||0;
if(!tipo||medida<=0){alert('Complete los datos');return;}

let usd=precios.usd||1, eur=precios.eur||1;
let totalMuro=0,totalRepello=0,totalFino=0;
let r=`<h3>Resultados</h3>
<strong>Dimensiones:</strong><br>
Largo: ${l} m | Ancho: ${a} m ${tipo==='hormigon'?`| Alto: ${h} m`:''}<br>
${tipo==='hormigon'?`Volumen:`:`Área:`} ${medida.toFixed(2)} ${tipo==='hormigon'?'m³':'m²'}<br>`;

r+='<h4>Muro (sin repello ni fino)</h4>';

if(tipo==='bloque'){
let bloques=medida*12;
let pBloque=bloquesPrecio.find(b=>b.nombre===materialMuro.value)?.precio||0;
let cem=medida*0.02, arena=medida*0.04, agua=medida*10;
let cBloque=bloques*pBloque;
let cCem=cem*(precios.P250||0);
let cArena=arena*(precios.arena||0);
totalMuro=cBloque+cCem+cArena;

r+=`Bloques: ${bloques.toFixed(0)} = ${cBloque.toFixed(2)} CUP<br>
Cemento: ${cem.toFixed(2)} sacos = ${cCem.toFixed(2)} CUP<br>
Arena: ${arena.toFixed(2)} m³ = ${cArena.toFixed(2)} CUP<br>
Agua: ${agua.toFixed(0)} L<br>`;
}

if(tipo==='hormigon'){
let v=medida;
let cem=v*7, arena=v*0.5, grav=v*0.8, acero=v*80, agua=v*180;
let cCem=cem*(precios.P350||0);
let cArena=arena*(precios.arena||0);
let cGrav=grav*(precios.gravilla||0);
let cAcero=acero*(precios.acero10||0);
totalMuro=cCem+cArena+cGrav+cAcero;

r+=`Cemento: ${cem} sacos = ${cCem.toFixed(2)} CUP<br>
Arena: ${arena} m³ = ${cArena.toFixed(2)} CUP<br>
Gravilla: ${grav} m³ = ${cGrav.toFixed(2)} CUP<br>
Acero: ${acero} kg = ${cAcero.toFixed(2)} CUP<br>
Agua: ${agua} L<br>`;
}

let cemR=medida*0.015, arenaR=medida*0.03, aguaR=medida*8;
totalRepello=cemR*(precios.P250||0)+arenaR*(precios.arena||0);

r+=`<h4>Repello</h4>
Cemento: ${cemR.toFixed(2)} sacos<br>
Arena: ${arenaR.toFixed(2)} m³<br>
Agua: ${aguaR.toFixed(0)} L<br>
Costo: ${totalRepello.toFixed(2)} CUP<br>`;

let cemF=medida*0.01, arenaF=medida*0.02, aguaF=medida*5;
totalFino=cemF*(precios.P250||0)+arenaF*(precios.arenaFina||0);

r+=`<h4>Fino</h4>
Cemento: ${cemF.toFixed(2)} sacos<br>
Arena fina: ${arenaF.toFixed(2)} m³<br>
Agua: ${aguaF.toFixed(0)} L<br>
Costo: ${totalFino.toFixed(2)} CUP<br>`;

let total=totalMuro+totalRepello+totalFino;
r+=`<h4>Resumen de precios</h4>
Muro: ${totalMuro.toFixed(2)} CUP<br>
Muro + Repello: ${(totalMuro+totalRepello).toFixed(2)} CUP<br>
Total general: <strong>${total.toFixed(2)} CUP</strong><br>
USD: ${(total/usd).toFixed(2)} | EUR: ${(total/eur).toFixed(2)}`;

resultado.innerHTML=r;
resultado.style.display='block';
}

function borrarMuro(){
document.querySelectorAll('input').forEach(i=>i.value='');
resultado.style.display='none';
materialCard.style.display='none';
}
</script>

</body>
</html>
