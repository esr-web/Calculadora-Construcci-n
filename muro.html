<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Muro - Calculadora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/style.css">
<style>
.header{background:#1f2937;color:#fff;padding:1rem;text-align:center;position:sticky;top:0}
.nav-menu{display:flex;gap:.5rem;justify-content:center}
.nav-link{background:#f0f0f0;padding:.5rem 1rem;border-radius:10px;text-decoration:none}
.container{max-width:900px;margin:2rem auto;padding:0 1rem}
.card{background:#fff;padding:1rem;margin-bottom:1rem;border-radius:14px;box-shadow:0 4px 8px rgba(0,0,0,.05)}
.card label{font-weight:500;display:block;margin-top:.5rem}
.card input,.card select{width:100%;padding:.5rem;border-radius:8px;border:1px solid #ccc}
.btn-primary{display:block;margin:1rem auto;padding:.7rem 2rem;background:#1f2937;color:#fff;border:none;border-radius:10px}
.result{background:#f9f9f9;padding:1rem;border-radius:12px;flex:1}
</style>
</head>

<body>

<header class="header">
<h1>Calculadora de Muros</h1>
<nav class="nav-menu">
<a href="index.html" class="nav-link">Inicio</a>
<a href="precios.html" class="nav-link">Precios</a>
</nav>
</header>

<main class="container">

<div class="card">
<label>Tipo de muro</label>
<select id="tipoMuro">
<option value="">-- Selecciona --</option>
<option value="bloque">Bloque</option>
<option value="ladrillo">Ladrillo</option>
<option value="hormigon">Hormigón armado</option>
</select>
</div>

<div class="card" id="materialCard" style="display:none">
<label>Material específico</label>
<select id="materialMuro"></select>
</div>

<div class="card" id="formaLadrilloCard" style="display:none">
<label>Forma de colocación</label>
<select id="formaLadrillo">
<option value="citara">Citara</option>
<option value="citaron">Citarón</option>
<option value="alicatado">Alicatado</option>
</select>
</div>

<div class="card">
<label>Largo (m)</label><input id="largo" type="number">
<label>Ancho (m)</label><input id="ancho" type="number">
<label id="labelAlto" style="display:none">Alto (m)</label>
<input id="alto" type="number" style="display:none">
<label>Área / Volumen</label>
<input id="area" readonly>
</div>

<button class="btn-primary" onclick="calcularMuro()">Calcular</button>
<button class="btn-primary" style="background:#ef4444" onclick="borrarMuro()">Borrar</button>

<div style="display:flex;gap:1rem;flex-wrap:wrap">
<div id="resultado" class="result" style="display:none"></div>
<div id="tarjetaTecnica" class="card" style="flex:1;display:none"></div>
</div>

</main>

<footer style="text-align:center;padding:1rem">Arq. Emanuel Silva Riambaut</footer>

<script>
const precios = JSON.parse(localStorage.getItem('precios')) || {};
const USD = precios.usd || 1, EUR = precios.eur || 1;

tipoMuro.onchange=()=>{
 materialMuro.innerHTML='';
 materialCard.style.display='block';
 formaLadrilloCard.style.display='none';
 alto.style.display = labelAlto.style.display = tipoMuro.value==='hormigon'?'block':'none';

 if(tipoMuro.value==='bloque'){
  materialMuro.innerHTML+=`<option value="0.15">Bloque 15 cm</option>`;
 }
 if(tipoMuro.value==='ladrillo'){
  materialMuro.innerHTML+=`<option value="0.12">Ladrillo macizo</option>`;
  formaLadrilloCard.style.display='block';
 }
 if(tipoMuro.value==='hormigon'){
  materialMuro.innerHTML+=`<option value="0.15">Hormigón armado</option>`;
 }
};

['largo','ancho','alto'].forEach(i=>{
 document.getElementById(i).oninput=()=>{
  area.value = tipoMuro.value==='hormigon'
  ? (largo.value*ancho.value*alto.value||0).toFixed(2)
  : (largo.value*ancho.value||0).toFixed(2);
 };
});

function costo(q,p){return q*p}

function calcularMuro(){
 if(!tipoMuro.value||area.value<=0){alert('Datos incompletos');return;}
 let A=+area.value, esp=+materialMuro.value;
 let totalBase=0, totalAcab=0;
 let html='<h3>Muro SIN repello ni fino</h3>';

 let cem=A*0.02, ar=A*0.04;
 let cCem=costo(cem,precios.P350), cAr=costo(ar,precios.arena);
 totalBase+=cCem+cAr;

 html+=`Cemento: ${cem.toFixed(2)} sacos → ${cCem.toFixed(2)} CUP<br>
 Arena: ${ar.toFixed(2)} m³ → ${cAr.toFixed(2)} CUP<br>`;

 let cemR=A*0.015*2, arR=A*0.03*2;
 let cemF=A*0.01*2, arF=A*0.02*2;
 totalAcab = totalBase +
 cemR*precios.P350 + arR*precios.arena +
 cemF*precios.P350 + arF*precios.arenaFina;

 html+=`<h4>Total SIN acabado</h4>
 ${totalBase.toFixed(2)} CUP |
 ${(totalBase/USD).toFixed(2)} USD |
 ${(totalBase/EUR).toFixed(2)} EUR`;

 html+=`<h3>Muro CON repello y fino (ambas caras)</h3>
 Repello + Fino: ${(totalAcab-totalBase).toFixed(2)} CUP<br>
 <strong>Total:</strong> ${totalAcab.toFixed(2)} CUP |
 ${(totalAcab/USD).toFixed(2)} USD |
 ${(totalAcab/EUR).toFixed(2)} EUR`;

 let horas = tipoMuro.value==='hormigon'
 ? (A/0.5).toFixed(1)
 : (A/2).toFixed(1);

 html+=`<p><strong>Tiempo de ejecución:</strong> ${horas} horas</p>`;

 resultado.innerHTML=html;
 resultado.style.display='block';

 tarjetaTecnica.innerHTML=`
 <h3>Ficha técnica del muro</h3>
 <p><strong>Tipo:</strong> ${tipoMuro.value}</p>
 <p><strong>Largo:</strong> ${largo.value} m</p>
 <p><strong>Alto:</strong> ${ancho.value} m</p>
 <p><strong>Espesor:</strong> ${esp} m</p>
 <p><strong>Junta de mortero:</strong> 10 mm</p>
 <p><strong>Resistencia estimada:</strong> 30–50 kg/cm²</p>
 <p><strong>Sistema constructivo:</strong> mampostería tradicional</p>
 <p><strong>Uso:</strong> cerramiento / divisor</p>`;
 tarjetaTecnica.style.display='block';
}

function borrarMuro(){
 document.querySelectorAll('input').forEach(i=>i.value='');
 resultado.style.display=tarjetaTecnica.style.display='none';
 materialCard.style.display=formaLadrilloCard.style.display='none';
}
</script>

</body>
</html>
